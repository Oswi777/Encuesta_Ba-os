<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reportes – Baños</title>

  <link rel="stylesheet" href="/static/css/brand.css">
  <link rel="stylesheet" href="/static/reportes/assets/css/reportes.css">

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script type="module" defer src="/static/reportes/assets/js/reportes.js"></script>
</head>

<body class="bg">
  <div class="wrap">
    <header class="head">
      <h1>Reportes – Baños</h1>
      <div class="filters">
        <label>Desde <input id="desde" type="date"></label>
        <label>Hasta <input id="hasta" type="date"></label>
        <label>Zona
          <select id="f_zona">
            <option value="">Todas</option>
          </select>
        </label>
        <label>Baño
          <select id="f_bano">
            <option value="">Todos</option>
          </select>
        </label>
        <button id="refrescar" class="btn small" type="button">Actualizar</button>
        <button id="limpiar" class="btn small" type="button" title="Borrar filtros guardados">Limpiar filtros</button>

        <!-- Auto-refresh -->
        <label style="display:flex;align-items:center;gap:6px;margin-left:8px;">
          <input id="auto_toggle" type="checkbox" />
          Auto cada
        </label>
        <input id="auto_interval" type="number" min="5" max="300" value="10"
               class="input" style="width:84px;padding:8px 10px;">
        <span class="muted">s</span>
      </div>
      <div id="filters_hint" class="muted" style="margin-top:6px;"></div>
    </header>

    <section class="kpis">
      <div class="kpi">
        <div class="kpi-val" id="k_total">0</div>
        <div class="kpi-label">Reportes</div>
      </div>
      <div class="kpi">
        <div class="kpi-val" id="k_top_bano">—</div>
        <div class="kpi-label">Baño con más incidencias</div>
      </div>
    </section>

    <section class="card">
      <h2>Tendencia diaria</h2>
      <canvas id="chartDia" height="140"></canvas>
    </section>

    <section class="grid-2">
      <div class="card">
        <h2>Por categoría</h2>
        <canvas id="chartCat" height="200"></canvas>
      </div>
      <div class="card">
        <h2>Top baños</h2>
        <canvas id="chartBanos" height="200"></canvas>
      </div>
    </section>

    <section class="card">
      <h2>Por zona</h2>
      <canvas id="chartZona" height="140"></canvas>
    </section>

    <section class="card" id="sec_hist">
      <h2>Últimas respuestas</h2>
      <div class="row" style="justify-content:space-between; gap:8px; margin:8px 0;">
        <div class="muted" id="hist_info">—</div>
        <div>
          <button id="hist_prev" class="btn small" type="button">« Prev</button>
          <button id="hist_next" class="btn small" type="button">Next »</button>
        </div>
      </div>
      <div class="table-wrap">
        <table class="tbl">
          <thead>
            <tr>
              <th>Fecha (Local)</th>
              <th>Categoría</th>
              <th>Baño</th>
              <th>Zona</th>
              <th>Piso</th>
              <th>Sexo</th>
              <th>Comentario</th>
            </tr>
          </thead>
          <tbody id="hist_tbody"></tbody>
        </table>
      </div>
    </section>

  </div>
</body>
</html>
